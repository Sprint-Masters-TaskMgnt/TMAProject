@{
    ViewData["Title"] = "Update User Role";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"]</title>

    <!-- Include Bootstrap for styling -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/css/bootstrap.min.css" rel="stylesheet" />

    <style>
        /* Custom Styles */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .alert {
            display: none;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>Update User Role</h2>
        <div class="alert alert-success" id="successMessage"></div>
        <div class="alert alert-danger" id="errorMessage"></div>

        <form id="updateUserRoleForm">
            <div class="form-group">
                <label for="id">User ID</label>
                <input type="number" class="form-control" id="id" placeholder="Enter User ID" required />
            </div>

            <div class="form-group">
                <label for="roleId">Role ID</label>
                <select class="form-control" id="roleId" required>
                    <option value="">Select Role</option>
                    <option value="1">Admin</option>
                    <option value="2">User</option>
                    <!-- Add more roles as needed -->
                </select>
            </div>

            <button type="submit" class="btn btn-primary">Update Role</button>
        </form>
    </div>

    <!-- Fetch API Script -->
    <script>document.addEventListener("DOMContentLoaded", function () {
            // Handle form submission
            document.getElementById("updateUserRoleForm").addEventListener("submit", function (e) {
                e.preventDefault();  // Prevent form from submitting normally

                // Get form data
                var userId = document.getElementById("id").value;
                var roleId = document.getElementById("roleId").value;

                // Validate input fields
                if (!userId || !roleId) {
                    document.getElementById("errorMessage").textContent = "Please provide both User ID and Role ID.";
                    document.getElementById("errorMessage").style.display = "block";
                    return;
                }

                // Prepare the data to send to the API
                var updateRoleRequest = {
                    RoleId: roleId
                };

                // Perform the fetch request to update the user role
                fetch('https://localhost:7071/api/Users/updateUserRole/${userId}', {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(updateRoleRequest)  // Send RoleId in the request body
                })
                    .then(response => response.json())
                    .then(data => {
                        // Success handler
                        document.getElementById("successMessage").textContent = data.message || "User role updated successfully.";
                        document.getElementById("successMessage").style.display = "block";
                        document.getElementById("errorMessage").style.display = "none";

                        // Optionally, clear the form
                        document.getElementById("id").value = '';
                        document.getElementById("roleId").value = '';
                    })
                    .catch(error => {
                        // Error handler
                        document.getElementById("errorMessage").textContent = error.message || "An error occurred. Please try again.";
                        document.getElementById("errorMessage").style.display = "block";
                        document.getElementById("successMessage").style.display = "none";
                    });
            });
        });</script>

</body>
</html>